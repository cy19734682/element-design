(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50136518"],{2588:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"app-search-table"},[a("em-search-form",{ref:"searchFormRef",attrs:{"form-data":e.searchFormData,btnLoading:""},on:{"on-search":e.search}},[a("template",{slot:"beginBtnGroup"},[a("el-button",{attrs:{type:"success "},on:{click:function(t){return e.addData()}}},[e._v(" 新增 ")]),a("el-button",{attrs:{type:"danger",disabled:!(e.selectIds&&e.selectIds.length>0)},on:{click:function(t){return e.delData()}}},[e._v(" 删除 ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.exportTableExcel()}}},[e._v(" TABLE导出 ")]),a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.exportJsonExcel()}}},[e._v(" JSON导出 ")]),a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.exportJsonZip()}}},[e._v(" zip导出 ")])],1)],2),a("em-table-page",{ref:"tableRef",attrs:{id:"tablePage",radio:"",url:"/bt-table-page",isTable:!1,"row-gutter":15,columns:e.columns,searchData:e.searchData,orderKey:""},on:{"row-click":e.rowClick,"selection-change":e.selectionChange,"on-data-change":e.onDataChange}})],1),a("em-form-modal",{ref:"formModalRef",attrs:{title:e.activeRow.id?"编辑":"新增","form-data":e.formData,"form-rules":e.formRules,btnLoading:""},on:{"on-submit":e.onSubmit,"on-close":e.onClose}})],1)},l=[],o=a("fecf"),r=a("4050"),n={name:"emRowPageEx",data(){return{activeRow:{},selectIds:[],searchData:{},searchFormData:[{type:"input",key:"name",placeholder:"名称"},{type:"input",placeholder:"类型",key:"mimeType"},{type:"select",placeholder:"后缀",key:"extension",options:[{label:"jpg",val:".jpg"},{label:"html",val:".html"},{label:"png",val:".png"},{label:"jpeg",val:".jpeg"}]}],columns:[{key:"id",label:"ID",render:(e,t)=>e("el-popover",{props:{trigger:"hover"}},[e("el-image",{props:{fit:"fill"},attrs:{src:window.global.serverImg+t.row.file_path}}),e("el-image",{slot:"reference",props:{fit:"fill"},style:{width:"100%",height:"200px",margin:"0 auto"},attrs:{src:window.global.serverImg+t.row.file_path}})])},{key:"name",label:"名称"}],formData:[{type:"input",label:"名称",key:"name"},{type:"input",label:"类型",key:"mimeType"},{type:"select",label:"后缀",key:"extension",options:[{label:"jpg",val:".jpg"},{label:"html",val:".html"},{label:"png",val:".png"},{label:"jpeg",val:".jpeg"}]}],formRules:{name:{required:!0},mimeType:{required:!0},extension:{required:!0}}}},methods:{search(e){this.searchData=window._.cloneDeep(e)},rowClick(e){console.log(e)},selectionChange(e){console.log(e),this.selectIds=e.map(e=>e.id)},onDataChange(){this.$refs.searchFormRef.changeLoading(!1)},addData(){this.$refs.formModalRef.open()},delData(e){let t="";if(this.isValidVal(e))t=e;else{if(this.selectIds.length<=0)return void this.$message.warning("请选择数据");t=this.selectIds.join()}this.$msgbox.confirm("是否确认删除","提示").then(()=>{this.$request.delete("/bt-table",{ids:t}).then(()=>{this.$message.success("删除成功"),this.$refs.tableRef.getTableData()}).catch()}).catch(e=>{console.log(e)})},onClose(){setTimeout(()=>{this.$refs.formModalRef.resetForm(),this.activeRow={}},200)},onSubmit(e){let t="post";this.activeRow.id&&(t="put",e["id"]=this.activeRow.id),this.$request[t]("/bt-table",e,{isShowLoading:!0}).then(e=>{0===e.code?(this.$message.success("post"===t?"新增成功":"编辑成功"),this.$refs.tableRef.getTableData(),this.$refs.formModalRef.changeLoading(!1),this.$refs.formModalRef.close(),this.onClose()):(this.$refs.formModalRef.changeLoading(!1),this.$message.error(e.msg||"post"===t?"新增失败":"编辑失败"))}).catch(e=>{this.$refs.formModalRef.changeLoading(!1)})},exportJsonExcel(){const e=this.$refs.tableRef.dataT||[];let t=this.columns.filter(e=>e.key),a=t.map(e=>e.label),s=t.map(e=>e.key),l=e.map(e=>s.map(t=>e[t])),r="表格数据";Object(o["a"])({header:a,data:l,filename:r})},exportJsonZip(){const e=this.$refs.tableRef.dataT||[];let t=this.columns.filter(e=>e.key),a=t.map(e=>e.label),s=t.map(e=>e.key),l=e.map(e=>s.map(t=>e[t])),o="表格数据";Object(r["a"])(a,l,o,o)},exportTableExcel(){Object(o["b"])("tablePage",1,4,"表格数据")}}},i=n,c=(a("b72b"),a("2877")),p=Object(c["a"])(i,s,l,!1,null,"26cf190a",null);t["default"]=p.exports},"8be2":function(e,t,a){},b72b:function(e,t,a){"use strict";a("8be2")}}]);